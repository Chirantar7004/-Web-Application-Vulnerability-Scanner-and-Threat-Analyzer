import os

f=open('anal.txt')
user_var=[]
prevline=""
def all_occurences(file, str):
    initial = 0
    while True:
        initial = file.find(str, initial)
        if initial == -1: return
        yield initial
        initial += len(str)

i=0
while True:
	data=f.readline()
	if not data:
		break
	else:
		if 'document.write' in data:
			if 'script' in prevline:
				if(('href' in data)or('uri' in data)):
					print i
					print '\n'
					print "XSS vulnerability in "+data+'\n'			
					i=i+1
		else: 
			if 'function' in data:
				if 'script' in prevline:
					if 'prompt' in data:
						if 'eval' in data:
							z=list(all_occurences(data,"prompt"))
							m=list(all_occurences(data,"eval"))
							v=list(all_occurences(data,")"))
							b=list(all_occurences(data,"("))
				
							for no in z:
								no=no-2
								user_var.append(data[no])
							for x in user_var:
								q=list(all_occurences(data,x))			
							for s in m:
								for l in b:
									for w in v:
										for h in q:
											if(s<h)and(h<v)and(s+1==l)and(h>l):
												print vulnerability

	prevline=data	

f.close()
